C51 COMPILER V9.52.0.0   LED                                                               09/19/2017 14:43:51 PAGE 1   


C51 COMPILER V9.52.0.0, COMPILATION OF MODULE LED
OBJECT MODULE PLACED IN .\Output\LED.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE Code\LED.c OPTIMIZE(4,SPEED) BROWSE INCDIR(.\Code\Common;.\Code;.\Code\B
                    -SP;.\Code\N76E003_HW) DEFINE(FOSC_160000) DEBUG OBJECTEXTEND PRINT(.\LST\LED.lst) TABS(2) OBJECT(.\Output\LED.obj)

line level    source

   1          /*
   2            WIFI状态指示灯
   3            LED指示灯
   4          */
   5          #include "N76E003.h"
   6          #include "Common.h"
   7          #include "Function_define.h"
   8          #include "LED.h"
   9          /*
  10            LED IO初始化
  11            WIFI状态指示灯
  12            P1.7
  13            高电平点亮，低电平熄灭
  14          */
  15          void LED_Init(void)
  16          {
  17   1        P17_PushPull_Mode;
  18   1        LED_STATUS=0;
  19   1      }
  20          
  21          void Set_LED_WIFI(void)
  22          {
  23   1        LED_STATUS=1;
  24   1      }
  25          
  26          void Reset_LED_WIFI(void)
  27          {
  28   1        LED_STATUS=0;
  29   1      }
  30          
  31          void Turn_LED(void)
  32          {
  33   1        if(LED_STATUS)
  34   1          LED_STATUS = 0;
  35   1        else
  36   1          LED_STATUS = 1;
  37   1      }
  38          
  39          u16 wifi_connect_timeout = 0;
  40          u8 CheckWifiStatus(void)
  41          {
  42   1        if(wifi_connect_timeout)
  43   1          wifi_connect_timeout--;
  44   1        else
  45   1          return 1;//超时，WIFI断开
  46   1        
  47   1        return 0;//未超时，表示WIFI处于连接状态
  48   1      }
  49          
  50          void SetWifiStatus(void)
  51          {
  52   1        wifi_connect_timeout = WIFI_CONNECT_TIMEOUT;
  53   1      }
  54          
C51 COMPILER V9.52.0.0   LED                                                               09/19/2017 14:43:51 PAGE 2   

  55          /*
  56            LED闪烁
  57          */
  58          #define LED_FLASH_RATE  1000  //LED闪烁速率
  59          u16 led_Flash_Rate = LED_FLASH_RATE;
  60          void LED_Flash(void)
  61          {
  62   1        if(led_Flash_Rate)
  63   1          led_Flash_Rate--;
  64   1        else
  65   1        {
  66   2          led_Flash_Rate = LED_FLASH_RATE;
  67   2          Turn_LED();
  68   2        }
  69   1      }
  70          
  71          /*
  72            LED指示灯
  73          */
  74          void Indicator_Light(void)
  75          {
  76   1        //检测WIFI连接状态
  77   1        if(CheckWifiStatus())
  78   1        {
  79   2          //Reset_LED_WIFI();
  80   2          LED_Flash();
  81   2        }
  82   1        else
  83   1        {
  84   2          Set_LED_WIFI();
  85   2        } 
  86   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    120    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      4    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
